Review and refactor:
- Remove duplicate code
- Simplify complex conditionals
- Extract magic numbers to constants
- Ensure single responsibility